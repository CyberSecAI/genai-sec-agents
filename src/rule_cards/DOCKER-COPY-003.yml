id: DOCKER-COPY-003
title: "Use COPY instead of ADD"
scope: "dockerfile"
severity: medium
requirement: "Use COPY for local file transfers; reserve ADD only for explicit remote URL extraction (generally avoid)."
do:
  - "Replace ADD with COPY for deterministic behavior."
  - "Use multi-stage builds to control artifacts."
dont:
  - "Do not use ADD to fetch remote URLs."
detect:
  hadolint: ["DL3020"]
verify:
  tests:
    - "No ADD instructions present unless exception noted"
refs:
  asvs: ["V14.2"]
  owasp_cheatsheet: ["Docker Security"]
license:
  source: "OWASP Cheat Sheet Series (CC BY-SA 4.0)"
