id: DOCKER-PACKAGES-002
title: "Minimize packages and clean caches"
scope: "dockerfile"
severity: medium
requirement: "Install only required packages and remove package caches and build-time tools in the same layer."
do:
  - "Use --no-install-recommends (apt) / --no-cache (apk) where applicable."
  - "Combine install and cleanup in a single RUN layer."
dont:
  - "Do not leave package manager caches in the image."
detect:
  hadolint: []
verify:
  tests:
    - "Image size reduced vs baseline"
refs:
  asvs: ["V14.4"]
  owasp_cheatsheet: ["Docker Security"]
license:
  source: "OWASP Cheat Sheet Series (CC BY-SA 4.0)"
