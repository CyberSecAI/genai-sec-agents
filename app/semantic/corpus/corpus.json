{
  "content": "Rule ID: INPUT-VALIDATION-003\nTitle: Implement email address validation with syntactic and semantic checks\nSeverity: medium\nScope: web-application\nRequirement: Validate email addresses with both syntactic and semantic checks to ensure correct format and legitimacy.\nSecure Practices:\n  \u2022 Check for two parts separated by '@' symbol in email addresses\n  \u2022 Ensure email addresses do not contain dangerous characters\n  \u2022 Validate domain part with letters, numbers, hyphens, and periods only\n  \u2022 Perform semantic validation by sending confirmation emails for ownership verification\nAvoid These Patterns:\n  \u2022 Accept email addresses without basic syntactic validation\n  \u2022 Rely solely on regular expressions for email address validation\nDetection Methods:\n  semgrep: generic.validation.email-syntactic-check, java.spring.security.spring-email-validation, python.django.security.audit.avoid-unsafe-deserialization, python.flask.security.audit.direct-use-of-jinja2, java.spring.security.audit.spring-unvalidated-redirect\n  trufflehog: Email address validation issues\nCWE: CWE-20, CWE-116\nASVS: V6.1.1, V6.1.2\nOWASP: A03:2021, C3:2024\nSource: app/rule_cards/owasp/input_validation/INPUT-VALIDATION-003.yml\nType: owasp_generated\n==================================================\nRule ID: INPUT-VALIDATION-001\nTitle: Implement syntactic and semantic input validation for all user inputs\nSeverity: high\nScope: web-application\nRequirement: All user inputs, including data from untrusted sources, must undergo both syntactic and semantic validation to ensure correct syntax and values in the specific business context.\nSecure Practices:\n  \u2022 Enforce correct syntax for structured fields (e.g., SSN, date, currency symbol)\n  \u2022 Ensure correctness of values in the specific business context (e.g., start date before end date)\n  \u2022 Use data type validators provided by web application frameworks or custom validators\n  \u2022 Validate input against JSON Schema or XML Schema for structured data\nAvoid These Patterns:\n  \u2022 Rely solely on client-side validation for input validation\n  \u2022 Accept inputs without proper syntactic and semantic validation\nDetection Methods:\n  semgrep: python.django.security.django-input-validation, java.spring.security.spring-input-validation, python.django.security.audit.avoid-unsafe-deserialization, python.flask.security.audit.direct-use-of-jinja2, java.spring.security.audit.spring-unvalidated-redirect\n  trufflehog: Structured data validation issues\nCWE: CWE-20, CWE-116\nASVS: V6.1.1, V6.1.2\nOWASP: A03:2021, C3:2024\nSource: app/rule_cards/owasp/input_validation/INPUT-VALIDATION-001.yml\nType: owasp_generated\n==================================================\nRule ID: INPUT-VALIDATION-002\nTitle: Implement allowlist validation for all user inputs\nSeverity: high\nScope: web-application\nRequirement: Implement allowlist validation for all user inputs to define exactly what is authorized, ensuring that only authorized inputs are accepted.\nSecure Practices:\n  \u2022 Define strong validation patterns based on regular expressions for structured data\n  \u2022 Match input against a fixed set of options for dropdown lists or radio buttons\n  \u2022 Use allowlist validation for all user-provided input fields\nAvoid These Patterns:\n  \u2022 Rely solely on denylist validation for input validation\n  \u2022 Accept inputs without matching them against an allowlist\nDetection Methods:\n  semgrep: generic.validation.allowlist, javascript.security.allowlist-validation, python.django.security.audit.avoid-unsafe-deserialization, python.flask.security.audit.direct-use-of-jinja2, java.spring.security.audit.spring-unvalidated-redirect\n  trufflehog: Allowlist validation issues\nCWE: CWE-20, CWE-116\nASVS: V6.1.1, V6.1.2\nOWASP: A03:2021, C3:2024\nSource: app/rule_cards/owasp/input_validation/INPUT-VALIDATION-002.yml\nType: owasp_generated\n==================================================\nRule ID: CLICKJACKING-DEFENSE-003\nTitle: Secure session cookies with SameSite attribute to mitigate Clickjacking\nSeverity: medium\nScope: web-application\nRequirement: Mark session cookies with SameSite attribute as 'strict' or 'lax' to prevent them from being included in requests made to a page within an iframe. This helps defend against Clickjacking attacks by ensuring that authenticated sessions are not vulnerable to being hijacked.\nSecure Practices:\n  \u2022 Set SameSite attribute to 'strict' for session cookies to prevent them from being sent in cross-origin requests\n  \u2022 Consider using SameSite attribute 'lax' for session cookies to allow them in top-level navigations and safe HTTP methods\nAvoid These Patterns:\n  \u2022 Do not solely rely on SameSite attribute for Clickjacking defense, use in conjunction with other mechanisms\nDetection Methods:\n  semgrep: http.cookie.samesite-strict, http.cookie.samesite-lax, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\n  trufflehog: SameSite Cookie Attribute, Basic Auth\nCWE: CWE-693, CWE-1021\nASVS: V6.1.1, V6.1.2\nOWASP: A6:2021\nSource: app/rule_cards/owasp/clickjacking_defense/CLICKJACKING-DEFENSE-003.yml\nType: owasp_generated\n==================================================\nRule ID: CLICKJACKING-DEFENSE-001\nTitle: Implement X-Frame-Options header to prevent Clickjacking\nSeverity: high\nScope: web-application\nRequirement: Set the X-Frame-Options HTTP response header to DENY, SAMEORIGIN, or ALLOW-FROM uri to prevent the browser from loading the page in a frame. This helps defend against Clickjacking attacks by ensuring content is not embedded into other sites.\nSecure Practices:\n  \u2022 Set X-Frame-Options header to DENY to prevent any domain from framing the content\n  \u2022 Set X-Frame-Options header to SAMEORIGIN to only allow the current site to frame the content\n  \u2022 Use ALLOW-FROM uri to permit specific URIs to frame the page (deprecated, check browser support)\nAvoid These Patterns:\n  \u2022 Do not rely solely on meta-tags for X-Frame-Options, apply the header in HTTP responses\nDetection Methods:\n  semgrep: http.response-header.x-frame-options-deny, http.response-header.x-frame-options-sameorigin, http.response-header.x-frame-options-allow-from, python.django.security.audit.xss-filter-disabled, python.flask.security.audit.flask-cors-origin-wildcard, java.spring.security.audit.spring-security-headers\n  trufflehog: X-Frame-Options\nCWE: CWE-693, CWE-1021\nASVS: V6.1.1, V6.1.2\nOWASP: A6:2021\nSource: app/rule_cards/owasp/clickjacking_defense/CLICKJACKING-DEFENSE-001.yml\nType: owasp_generated\n==================================================\nRule ID: CLICKJACKING-DEFENSE-002\nTitle: Utilize Content Security Policy (CSP) frame-ancestors to prevent Clickjacking\nSeverity: medium\nScope: web-application\nRequirement: Implement the frame-ancestors directive in Content-Security-Policy HTTP response header to control which domains are allowed to render a page in a frame or iframe. This helps defend against Clickjacking attacks by preventing content from being embedded into unauthorized sites.\nSecure Practices:\n  \u2022 Use frame-ancestors 'none' to prevent any domain from framing the content\n  \u2022 Specify frame-ancestors 'self' to only allow the current site to frame the content\n  \u2022 Authorize specific domains using frame-ancestors directive\nAvoid These Patterns:\n  \u2022 Do not forget to include the frame-ancestors directive in the Content-Security-Policy header\nDetection Methods:\n  semgrep: http.response-header.content-security-policy-frame-ancestors-none, http.response-header.content-security-policy-frame-ancestors-self, http.response-header.content-security-policy-frame-ancestors-specific, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\n  trufflehog: Content-Security-Policy, Basic Auth\nCWE: CWE-693, CWE-1021\nASVS: V6.1.1, V6.1.2\nOWASP: A6:2021\nSource: app/rule_cards/owasp/clickjacking_defense/CLICKJACKING-DEFENSE-002.yml\nType: owasp_generated\n==================================================\nRule ID: FILE-UPLOAD-003\nTitle: Implement file size and type validation\nSeverity: medium\nScope: web-application\nRequirement: Enforce file size limits and validate file signatures to prevent DoS attacks and malicious uploads.\nSecure Practices:\n  \u2022 Set file size limits to prevent excessive storage usage\n  \u2022 Validate file signatures in addition to content type\n  \u2022 Implement request limits for download service to prevent DoS attacks\nAvoid These Patterns:\n  \u2022 Avoid accepting excessively large files without proper validation\n  \u2022 Do not solely rely on file size limits for security\nDetection Methods:\n  semgrep: file-upload.security.file-size-validation, file-upload.security.file-signature-validation, python.django.security.audit.avoid-unsafe-deserialization, python.flask.security.audit.direct-use-of-jinja2, java.spring.security.audit.spring-unvalidated-redirect\n  trufflehog: DoS Attack via File Upload, Malicious File Upload\nCWE: CWE-770, CWE-326\nASVS: V6.2.1, V6.2.2\nOWASP: A06:2021, A09:2021\nSource: app/rule_cards/owasp/file_upload/FILE-UPLOAD-003.yml\nType: owasp_generated\n==================================================\nRule ID: FILE-UPLOAD-002\nTitle: Secure file naming and storage location\nSeverity: high\nScope: web-application\nRequirement: Generate random filenames for uploaded files and store them in a secure location outside the webroot to prevent direct access.\nSecure Practices:\n  \u2022 Generate unique filenames using UUID/GUID\n  \u2022 Implement filename length limits and restrict characters to a safe subset\n  \u2022 Store files on a different server or outside the webroot\n  \u2022 Set proper permissions for file storage location\nAvoid These Patterns:\n  \u2022 Avoid using user-provided filenames directly\n  \u2022 Do not store files in the webroot where they can be accessed directly\nDetection Methods:\n  semgrep: file-upload.security.filename-generation, file-upload.security.storage-location, python.django.security.audit.unescaped-file-extension, java.spring.security.audit.spring-file-upload-filename, php.lang.security.file-inclusion.file-inclusion\nCWE: CWE-116, CWE-379\nASVS: V6.3.1, V6.3.2\nOWASP: A05:2021, A07:2021\nSource: app/rule_cards/owasp/file_upload/FILE-UPLOAD-002.yml\nType: owasp_generated\n==================================================\nRule ID: FILE-UPLOAD-001\nTitle: Validate file extensions and content types\nSeverity: high\nScope: web-application\nRequirement: Implement input validation to check file extensions against a whitelist of allowed extensions. Additionally, validate the file's content type to prevent malicious uploads.\nSecure Practices:\n  \u2022 List allowed extensions for each file type and validate against them\n  \u2022 Check file content type in addition to file extension\n  \u2022 Implement both allowlist and denylist approaches for content type validation\n  \u2022 Use secure libraries or tools to determine file content type\nAvoid These Patterns:\n  \u2022 Do not rely solely on file extensions for validation\n  \u2022 Do not trust the Content-Type header provided by users\nDetection Methods:\n  semgrep: file-upload.security.extension-validation, file-upload.security.content-type-validation, python.django.security.audit.avoid-unsafe-deserialization, python.flask.security.audit.direct-use-of-jinja2, java.spring.security.audit.spring-unvalidated-redirect\n  trufflehog: File Extension Bypass, Content-Type Spoofing\nCWE: CWE-434, CWE-918\nASVS: V6.1.1, V6.1.2\nOWASP: A04:2021, A08:2021\nSource: app/rule_cards/owasp/file_upload/FILE-UPLOAD-001.yml\nType: owasp_generated\n==================================================\nRule ID: HTTP-HEADERS-XSS-PROTECTION-002\nTitle: Mitigate XSS attacks with X-XSS-Protection header\nSeverity: high\nScope: web-application\nRequirement: Implement X-XSS-Protection header to prevent reflected cross-site scripting (XSS) attacks by stopping pages from loading when XSS attacks are detected.\nSecure Practices:\n  \u2022 Use Content Security Policy (CSP) to disable inline JavaScript\n  \u2022 Consider not setting X-XSS-Protection header or explicitly turning it off\nAvoid These Patterns:\n  \u2022 Do not rely solely on X-XSS-Protection header for XSS protection\nDetection Methods:\n  semgrep: http.x-xss-protection.enabled, http.x-xss-protection.disabled, python.django.security.audit.xss.direct-use-of-httpresp-write, javascript.browser.security.audit.dom-based-xss, java.spring.security.audit.spring-xss\n  trufflehog: X-XSS-Protection\nCWE: CWE-79, CWE-116\nOWASP: A03:2021, A07:2021\nSource: app/rule_cards/owasp/http_headers/HTTP-HEADERS-XSS-PROTECTION-002.yml\nType: owasp_generated\n==================================================\nRule ID: HTTP-HEADERS-CONTENT-TYPE-003\nTitle: Prevent MIME type confusion with X-Content-Type-Options header\nSeverity: medium\nScope: web-application\nRequirement: Implement X-Content-Type-Options header to prevent MIME type sniffing by instructing browsers to follow the MIME types advertised in the Content-Type headers.\nSecure Practices:\n  \u2022 Set X-Content-Type-Options header to nosniff to block MIME type sniffing\n  \u2022 Ensure Content-Type header is set correctly throughout the site\nAvoid These Patterns:\n  \u2022 Do not rely solely on X-Content-Type-Options header for MIME type security\nDetection Methods:\n  semgrep: http.x-content-type-options.nosniff, python.django.security.audit.xss-filter-disabled, python.flask.security.audit.flask-cors-origin-wildcard, java.spring.security.audit.spring-security-headers\n  trufflehog: X-Content-Type-Options\nCWE: CWE-434, CWE-116\nOWASP: A03:2021, A07:2021\nSource: app/rule_cards/owasp/http_headers/HTTP-HEADERS-CONTENT-TYPE-003.yml\nType: owasp_generated\n==================================================\nRule ID: HTTP-HEADERS-X-FRAME-OPTIONS-001\nTitle: Prevent Clickjacking attacks with X-Frame-Options header\nSeverity: high\nScope: web-application\nRequirement: Implement X-Frame-Options header to prevent Clickjacking attacks by specifying whether a browser should be allowed to render a page in a frame.\nSecure Practices:\n  \u2022 Set X-Frame-Options header to DENY to disallow displaying the page in a frame\n  \u2022 Consider using Content Security Policy (CSP) frame-ancestors directive for supporting browsers\nAvoid These Patterns:\n  \u2022 Do not allow the page to be displayed in a frame without proper validation\nDetection Methods:\n  semgrep: http.x-frame-options.deny, http.x-frame-options.allow-from, python.django.security.audit.xss-filter-disabled, python.flask.security.audit.flask-cors-origin-wildcard, java.spring.security.audit.spring-security-headers\n  trufflehog: X-Frame-Options\nCWE: CWE-693, CWE-1021\nOWASP: A06:2021, A09:2021\nSource: app/rule_cards/owasp/http_headers/HTTP-HEADERS-X-FRAME-OPTIONS-001.yml\nType: owasp_generated\n==================================================\nRule ID: LARAVEL-APP-KEY-001\nTitle: Generate and secure application key\nSeverity: high\nScope: web-application\nRequirement: Ensure that the application key is generated and securely stored to protect sensitive data encrypted using Laravel's encryption mechanisms.\nSecure Practices:\n  \u2022 Run 'php artisan key:generate' to generate a new application key\n  \u2022 Store the application key securely and avoid exposing it in version control\nAvoid These Patterns:\n  \u2022 Do not hardcode or expose the application key in source code\nDetection Methods:\n  semgrep: php.laravel.security.key-generation\n  custom: custom-laravel-app-key-001\nOWASP: A03:2021, A06:2021, A09:2021\nSource: app/rule_cards/owasp/laravel_security/LARAVEL-APP-KEY-001.yml\nType: owasp_generated\n==================================================\nRule ID: LARAVEL-COOKIE-001\nTitle: Secure cookie settings for Laravel application\nSeverity: medium\nScope: web-application\nRequirement: Configure secure cookie attributes to enhance the security of session management and prevent common attacks like session hijacking and XSS.\nSecure Practices:\n  \u2022 Enable cookie encryption middleware for sensitive data\n  \u2022 Set 'http_only' attribute to 'true' to prevent client-side script access\n  \u2022 Configure 'same_site' attribute to 'lax' or 'strict' for better cookie security\nAvoid These Patterns:\n  \u2022 Avoid disabling cookie encryption middleware without a specific use case\nDetection Methods:\n  semgrep: php.laravel.security.cookie-settings, python.django.security.audit.xss.direct-use-of-httpresp-write, javascript.browser.security.audit.dom-based-xss, java.spring.security.audit.spring-xss\nOWASP: A03:2021, A07:2021, A10:2021\nSource: app/rule_cards/owasp/laravel_security/LARAVEL-COOKIE-001.yml\nType: owasp_generated\n==================================================\nRule ID: LARAVEL-DEBUG-001\nTitle: Disable debug mode in production environment\nSeverity: high\nScope: web-application\nRequirement: Ensure that the 'APP_DEBUG' environment variable is set to 'false' in production to prevent sensitive information disclosure and potential security vulnerabilities.\nSecure Practices:\n  \u2022 Set 'APP_DEBUG=false' in the production environment configuration\nAvoid These Patterns:\n  \u2022 Do not expose debug information to end-users in production\nDetection Methods:\n  semgrep: php.security.ini.app-debug, python.logging.security.audit.logging-sensitive-data, java.lang.security.audit.system-exit, javascript.express.security.audit.express-expose-sensitive-data\nOWASP: A03:2021, A06:2021, A09:2021\nSource: app/rule_cards/owasp/laravel_security/LARAVEL-DEBUG-001.yml\nType: owasp_generated\n==================================================\nRule ID: SESSION-MANAGEMENT-003\nTitle: Enforce secure session management mechanisms\nSeverity: critical\nScope: web-application\nRequirement: Implement secure session management mechanisms like cookies with advanced attributes (Secure, HttpOnly), enforce HTTPS, and use advanced token properties to protect session IDs.\nSecure Practices:\n  \u2022 Use cookies with Secure and HttpOnly attributes for session management\n  \u2022 Enforce HTTPS for the entire web session, not just during authentication\n  \u2022 Implement advanced token properties like expiration date and granular usage constraints\nAvoid These Patterns:\n  \u2022 Allow session IDs to be exchanged through insecure channels\n  \u2022 Neglect to set Secure and HttpOnly attributes for session cookies\nDetection Methods:\n  semgrep: http.cookie-missing-secure-attribute, http.cookie-missing-httponly-attribute, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\n  trufflehog: Session ID, JWT Token\nCWE: CWE-614, CWE-319\nOWASP: A3:2021, A6:2021\nSource: app/rule_cards/owasp/session_management/SESSION-MANAGEMENT-003.yml\nType: owasp_generated\n==================================================\nRule ID: SESSION-MANAGEMENT-001\nTitle: Use generic session ID names to avoid fingerprinting\nSeverity: medium\nScope: web-application\nRequirement: Change default session ID names to generic names like 'id' to avoid disclosing technologies and programming languages used by the web application.\nSecure Practices:\n  \u2022 Update session ID names to generic terms to prevent fingerprinting\n  \u2022 Implement a random session ID generator with at least 64 bits of entropy\n  \u2022 Ensure session ID names do not reveal sensitive information\nAvoid These Patterns:\n  \u2022 Use default session ID names like 'PHPSESSID', 'JSESSIONID', 'ASP.NET_SessionId'\nDetection Methods:\n  semgrep: http.cookie-session-id-fingerprinting, http.cookie-session-id-disclosure, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\n  trufflehog: Generic API Key\nCWE: CWE-200, CWE-384\nOWASP: A3:2021, A6:2021\nSource: app/rule_cards/owasp/session_management/SESSION-MANAGEMENT-001.yml\nType: owasp_generated\n==================================================\nRule ID: SESSION-MANAGEMENT-002\nTitle: Implement strong session ID entropy to prevent brute-force attacks\nSeverity: high\nScope: web-application\nRequirement: Generate session IDs with at least 64 bits of entropy using a cryptographically secure pseudorandom number generator to prevent brute-force guessing attacks.\nSecure Practices:\n  \u2022 Use a strong CSPRNG to generate session IDs\n  \u2022 Ensure session IDs have at least 64 bits of entropy\n  \u2022 Consider different encoding methods to achieve required entropy\nAvoid These Patterns:\n  \u2022 Use predictable or weak session ID generation algorithms\nDetection Methods:\n  semgrep: http.session-id-weak-entropy, http.session-id-brute-force, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\nCWE: CWE-330, CWE-338\nOWASP: A3:2021, A6:2021\nSource: app/rule_cards/owasp/session_management/SESSION-MANAGEMENT-002.yml\nType: owasp_generated\n==================================================\nRule ID: NODEJS-SECURITY-001\nTitle: Use flat Promise chains to avoid Callback Hell\nSeverity: high\nScope: web-application\nRequirement: Avoid nested callback functions in Node.js applications to prevent the 'Pyramid of Doom' or 'Callback Hell' issue. Utilize Promises for top-down execution and error handling to improve code readability and maintainability.\nSecure Practices:\n  \u2022 Refactor asynchronous code to use flat Promise chains\n  \u2022 Utilize .then() and .catch() functions for error handling\n  \u2022 Consider using async/await for cleaner asynchronous code\nAvoid These Patterns:\n  \u2022 Do not create deeply nested callback functions\n  \u2022 Avoid relying solely on callbacks for error handling\nDetection Methods:\n  semgrep: javascript.nodejs.security.callback-hell, javascript.nodejs.security.promise-then-catch, javascript.nodejs.security.async-await, python.logging.security.audit.logging-sensitive-data, java.lang.security.audit.system-exit, javascript.express.security.audit.express-expose-sensitive-data\nCWE: CWE-829, CWE-691\nOWASP: A10:2021, A8:2021\nSource: app/rule_cards/owasp/nodejs_security/NODEJS-SECURITY-001.yml\nType: owasp_generated\n==================================================\nRule ID: NODEJS-SECURITY-003\nTitle: Prevent blocking the event loop with asynchronous operations\nSeverity: high\nScope: web-application\nRequirement: Avoid blocking the Node.js event loop with synchronous operations to maintain application responsiveness. Ensure all blocking operations are performed asynchronously to prevent delays in event processing and potential DoS vulnerabilities.\nSecure Practices:\n  \u2022 Use asynchronous operations for CPU-intensive tasks\n  \u2022 Avoid synchronous file operations that can block the event loop\n  \u2022 Utilize callbacks or Promises for non-blocking execution\nAvoid These Patterns:\n  \u2022 Do not perform synchronous operations in event loop\n  \u2022 Avoid synchronous file system operations\nDetection Methods:\n  semgrep: javascript.nodejs.security.blocking-event-loop, javascript.nodejs.security.sync-file-operations, javascript.express.security.audit.express-cors-origin-wildcard, javascript.lang.security.audit.crypto-js-hardcoded-secret, javascript.express.security.audit.express-helmet-disabled\nCWE: CWE-400, CWE-399\nOWASP: A7:2021, A1:2021\nSource: app/rule_cards/owasp/nodejs_security/NODEJS-SECURITY-003.yml\nType: owasp_generated\n==================================================\nRule ID: NODEJS-SECURITY-002\nTitle: Set request size limits to prevent DoS attacks\nSeverity: medium\nScope: web-application\nRequirement: Implement request size limits to prevent attackers from sending large request bodies that can exhaust server resources or fill up disk space. Utilize libraries like 'raw-body' to restrict the size of incoming requests based on content type.\nSecure Practices:\n  \u2022 Limit request body size for POST, PUT, and DELETE requests\n  \u2022 Validate request content type before processing\n  \u2022 Use 'raw-body' or similar libraries to set request size limits\nAvoid These Patterns:\n  \u2022 Do not allow unlimited request body sizes\n  \u2022 Avoid processing requests without size validation\nDetection Methods:\n  semgrep: javascript.nodejs.security.request-size-limits, javascript.nodejs.security.raw-body-usage, javascript.express.security.audit.express-cors-origin-wildcard, javascript.lang.security.audit.crypto-js-hardcoded-secret, javascript.express.security.audit.express-helmet-disabled\nCWE: CWE-770, CWE-400\nOWASP: A6:2021, A1:2021\nSource: app/rule_cards/owasp/nodejs_security/NODEJS-SECURITY-002.yml\nType: owasp_generated\n==================================================\nRule ID: ERROR-HANDLING-001\nTitle: Implement global error handling for Java web applications\nSeverity: high\nScope: web-application\nRequirement: Configure a global error handler in Java web applications to redirect to an error page, trace the error, and return a generic response without revealing implementation details.\nSecure Practices:\n  \u2022 Configure the web.xml file to define error-page for java.lang.Exception\n  \u2022 Create an error.jsp file to log the error, set HTTP response header, and return a generic JSON response\n  \u2022 Ensure the error.jsp file handles unexpected errors and returns a 500 status code\nAvoid These Patterns:\n  \u2022 Avoid exposing detailed error messages to users in production environments\nDetection Methods:\n  semgrep: java.servlet.error-page, java.servlet.error-handler, python.logging.security.audit.logging-sensitive-data, java.lang.security.audit.system-exit, javascript.express.security.audit.express-expose-sensitive-data\n  trufflehog: Java Error Handling Configuration\n  custom: Manual code review to ensure error handling is implemented correctly\nCWE: CWE-209, CWE-116\nASVS: V6.4.1, V6.4.2\nOWASP: A06:2021, A07:2021\nSource: app/rule_cards/owasp/error_handling/ERROR-HANDLING-001.yml\nType: owasp_generated\n==================================================\nRule ID: ERROR-HANDLING-002\nTitle: Implement global error handling for SpringMVC/SpringBoot applications\nSeverity: high\nScope: web-application\nRequirement: Define a global error handler in SpringMVC or SpringBoot applications to return a generic response for unexpected errors without exposing sensitive information.\nSecure Practices:\n  \u2022 Create a RestResponseEntityExceptionHandler class to handle exceptions extending java.lang.Exception\n  \u2022 Use ProblemDetail class to create the response object with a generic message\n  \u2022 Ensure the response includes an internal server error status code (500)\nAvoid These Patterns:\n  \u2022 Avoid returning detailed error messages to clients in production environments\nDetection Methods:\n  semgrep: spring.exception-handler, spring.problem-detail, python.logging.security.audit.logging-sensitive-data, java.lang.security.audit.system-exit, javascript.express.security.audit.express-expose-sensitive-data\n  trufflehog: Spring Error Handling Configuration\n  custom: Manual code review to validate error handling implementation\nCWE: CWE-209, CWE-116\nASVS: V6.4.1, V6.4.2\nOWASP: A06:2021, A07:2021\nSource: app/rule_cards/owasp/error_handling/ERROR-HANDLING-002.yml\nType: owasp_generated\n==================================================\nRule ID: ERROR-HANDLING-003\nTitle: Implement global error handling for ASP.NET Core web applications\nSeverity: high\nScope: web-application\nRequirement: Define a global error handler in ASP.NET Core applications to return a generic JSON response for unexpected errors and log error details without exposing sensitive information.\nSecure Practices:\n  \u2022 Create an ErrorController API Controller to handle all unexpected exceptions\n  \u2022 Build a generic JSON response with a message indicating an error occurred\n  \u2022 Set the HTTP status code to 500 for internal server errors\nAvoid These Patterns:\n  \u2022 Avoid leaking implementation details in error responses\nDetection Methods:\n  semgrep: aspnetcore.error-handler, aspnetcore.json-error-response, python.logging.security.audit.logging-sensitive-data, java.lang.security.audit.system-exit, javascript.express.security.audit.express-expose-sensitive-data\n  trufflehog: ASP.NET Core Error Handling Configuration\n  custom: Manual inspection to ensure error handling is correctly implemented\nCWE: CWE-209, CWE-116\nASVS: V6.4.1, V6.4.2\nOWASP: A06:2021, A07:2021\nSource: app/rule_cards/owasp/error_handling/ERROR-HANDLING-003.yml\nType: owasp_generated\n==================================================\nRule ID: SQL-INJECTION-PREVENTION-001\nTitle: Prevent SQL Injection with Prepared Statements\nSeverity: high\nScope: web-application\nRequirement: Developers must use prepared statements with parameterized queries to prevent SQL injection vulnerabilities. Prepared statements ensure that the database distinguishes between code and data, making it impossible for attackers to change the query's intent.\nSecure Practices:\n  \u2022 Use prepared statements with variable binding in database queries\n  \u2022 Define all SQL code first and pass in each parameter to the query later\n  \u2022 Ensure the database always distinguishes between code and data\nAvoid These Patterns:\n  \u2022 Avoid writing dynamic queries with string concatenation\n  \u2022 Do not allow user-supplied input to be directly appended to queries\nDetection Methods:\n  semgrep: java.sql.preparedstatement, csharp.sql.preparedstatement, hibernate.querylanguage.preparedstatement, python.django.security.injection.sql.django-sql-injection, python.sqlalchemy.security.audit.sqlalchemy-execute-raw-query, java.spring.security.audit.spring-sqli\n  trufflehog: SQL Injection\n  codeql: sql-injection\nCWE: CWE-89, CWE-564\nASVS: V6.1.1, V6.1.2\nOWASP: A1:2021, A4:2021\nSource: app/rule_cards/owasp/sql_injection_prevention/SQL-INJECTION-PREVENTION-001.yml\nType: owasp_generated\n==================================================\nRule ID: SQL-INJECTION-PREVENTION-002\nTitle: Implement Secure Stored Procedures\nSeverity: high\nScope: web-application\nRequirement: Developers must use properly constructed stored procedures to prevent SQL injection vulnerabilities. Stored procedures should be implemented safely with predefined SQL statements and parameters to ensure the database distinguishes between code and data.\nSecure Practices:\n  \u2022 Build SQL statements with parameters in stored procedures\n  \u2022 Ensure stored procedures are implemented safely to prevent SQL injection\n  \u2022 Define and store SQL code in the database itself, then call from the application\nAvoid These Patterns:\n  \u2022 Avoid using unsafe dynamic SQL generation within stored procedures\n  \u2022 Do not grant excessive execute rights to application accounts for stored procedures\nDetection Methods:\n  semgrep: java.sql.callablestatement, dotnet.sql.command, python.django.security.injection.sql.django-sql-injection, python.sqlalchemy.security.audit.sqlalchemy-execute-raw-query, java.spring.security.audit.spring-sqli\n  trufflehog: SQL Injection\n  codeql: sql-injection\nCWE: CWE-89, CWE-564\nASVS: V6.1.1, V6.1.2\nOWASP: A1:2021, A4:2021\nSource: app/rule_cards/owasp/sql_injection_prevention/SQL-INJECTION-PREVENTION-002.yml\nType: owasp_generated\n==================================================\nRule ID: SQL-INJECTION-PREVENTION-003\nTitle: Implement Allow-list Input Validation\nSeverity: medium\nScope: web-application\nRequirement: Developers must implement allow-list input validation for parts of SQL queries that can't use bind variables, such as table names or column names. Input validation should ensure that only legal and expected values are used in queries.\nSecure Practices:\n  \u2022 Validate input for table names, column names, or sort order indicators\n  \u2022 Map parameter values to legal and expected table or column names\n  \u2022 Use input validation to prevent unauthorized input in SQL queries\nAvoid These Patterns:\n  \u2022 Avoid using user parameter values directly for table or column names\n  \u2022 Do not allow unvalidated user input to be included in queries\nDetection Methods:\n  semgrep: input-validation.table-name, input-validation.column-name, python.django.security.audit.avoid-unsafe-deserialization, python.flask.security.audit.direct-use-of-jinja2, java.spring.security.audit.spring-unvalidated-redirect\n  trufflehog: SQL Injection\n  codeql: sql-injection\nCWE: CWE-89, CWE-564\nASVS: V6.1.1, V6.1.2\nOWASP: A1:2021, A4:2021\nSource: app/rule_cards/owasp/sql_injection_prevention/SQL-INJECTION-PREVENTION-003.yml\nType: owasp_generated\n==================================================\nRule ID: DOM-XSS-PREVENTION-RULE1\nTitle: HTML and JavaScript Encoding for Untrusted Data in HTML Subcontext\nSeverity: high\nScope: web-application\nRequirement: HTML escape and then JavaScript escape all untrusted data before inserting into HTML subcontext within the execution context to prevent DOM based XSS vulnerabilities.\nSecure Practices:\n  \u2022 Use HTML encoding followed by JavaScript encoding for untrusted data in HTML subcontext\n  \u2022 Utilize ESAPI or similar libraries for encoding untrusted data\nAvoid These Patterns:\n  \u2022 Do not directly insert untrusted data into HTML subcontext without proper encoding\nDetection Methods:\n  semgrep: javascript.security.dom-based-xss, python.django.security.audit.xss.direct-use-of-httpresp-write, javascript.browser.security.audit.dom-based-xss, java.spring.security.audit.spring-xss\nCWE: CWE-79\nOWASP: A7:2021, A2:2021\nSource: app/rule_cards/owasp/dom_xss_prevention/DOM-XSS-PREVENTION-RULE1.yml\nType: owasp_generated\n==================================================\nRule ID: DOM-XSS-PREVENTION-RULE3\nTitle: Avoid Untrusted Data in Event Handler and JavaScript Code Subcontexts\nSeverity: high\nScope: web-application\nRequirement: Avoid including untrusted data in event handler and JavaScript code subcontexts within an execution context to prevent DOM based XSS vulnerabilities.\nSecure Practices:\n  \u2022 Minimize usage of untrusted data in event handlers and JavaScript code subcontexts\n  \u2022 Prefer safe assignment properties like textContent for populating the DOM with untrusted data\nAvoid These Patterns:\n  \u2022 Do not directly insert untrusted data into event handlers or JavaScript code subcontexts\nDetection Methods:\n  semgrep: javascript.security.dom-based-xss, python.django.security.audit.xss.direct-use-of-httpresp-write, javascript.browser.security.audit.dom-based-xss, java.spring.security.audit.spring-xss\nCWE: CWE-79\nOWASP: A7:2021, A2:2021\nSource: app/rule_cards/owasp/dom_xss_prevention/DOM-XSS-PREVENTION-RULE3.yml\nType: owasp_generated\n==================================================\nRule ID: DOM-XSS-PREVENTION-RULE2\nTitle: JavaScript Escape for Untrusted Data in HTML Attribute Subcontext\nSeverity: medium\nScope: web-application\nRequirement: JavaScript escape untrusted data before inserting into HTML attribute subcontext within the execution context to prevent DOM based XSS vulnerabilities.\nSecure Practices:\n  \u2022 Use JavaScript encoding for untrusted data in HTML attribute subcontext\n  \u2022 Avoid unnecessary HTML attribute encoding in execution context\nAvoid These Patterns:\n  \u2022 Do not double-encode untrusted data in HTML attribute subcontext\nDetection Methods:\n  semgrep: javascript.security.dom-based-xss, python.django.security.audit.xss.direct-use-of-httpresp-write, javascript.browser.security.audit.dom-based-xss, java.spring.security.audit.spring-xss\nCWE: CWE-79\nOWASP: A7:2021, A2:2021\nSource: app/rule_cards/owasp/dom_xss_prevention/DOM-XSS-PREVENTION-RULE2.yml\nType: owasp_generated\n==================================================\nRule ID: AUTHENTICATION-001\nTitle: Implement Proper Password Strength Controls\nSeverity: high\nScope: web-application\nRequirement: Enforce a strong password policy including a minimum password length of 8 characters, allow passwords up to at least 64 characters, allow all characters including unicode and whitespace, implement credential rotation after a password leak, and provide a password strength meter for users.\nSecure Practices:\n  \u2022 Enforce minimum password length of 8 characters\n  \u2022 Allow passwords up to at least 64 characters\n  \u2022 Allow all characters including unicode and whitespace\n  \u2022 Implement credential rotation after a password leak\n  \u2022 Provide a password strength meter for users\nAvoid These Patterns:\n  \u2022 Do not enforce arbitrary periodic password changes\n  \u2022 Do not silently truncate passwords\nDetection Methods:\n  semgrep: password-hardcoded, password-length, password-rotation, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\n  trufflehog: Password Rotation, Weak Password Policy\nCWE: CWE-521, CWE-656\nASVS: V6.4.1, V6.4.2\nOWASP: A02:2021, A3:2021\nSource: app/rule_cards/owasp/authentication/AUTHENTICATION-001.yml\nType: owasp_generated\n==================================================\nRule ID: AUTHENTICATION-002\nTitle: Require Re-authentication for Sensitive Features\nSeverity: medium\nScope: web-application\nRequirement: Mandate re-authentication before allowing access to sensitive features or performing high-risk actions to mitigate CSRF and session hijacking risks.\nSecure Practices:\n  \u2022 Require current credentials for sensitive actions\n  \u2022 Implement re-authentication for password changes or sensitive transactions\n  \u2022 Invalidate sessions after re-authentication\nAvoid These Patterns:\n  \u2022 Do not allow sensitive actions without re-authentication\nDetection Methods:\n  semgrep: reauthentication-required, session-hijacking, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\n  trufflehog: Sensitive Action Re-authentication, Basic Auth\nCWE: CWE-384, CWE-613\nASVS: V2.2.2, V2.2.3\nOWASP: A2:2021, A5:2021\nSource: app/rule_cards/owasp/authentication/AUTHENTICATION-002.yml\nType: owasp_generated\n==================================================\nRule ID: AUTHENTICATION-003\nTitle: Protect Against Automated Attacks\nSeverity: high\nScope: web-application\nRequirement: Implement defenses against automated attacks including brute force, credential stuffing, and password spraying such as multi-factor authentication, login throttling, account lockout, CAPTCHA, and security questions.\nSecure Practices:\n  \u2022 Implement multi-factor authentication\n  \u2022 Enforce login throttling\n  \u2022 Implement account lockout after failed attempts\n  \u2022 Use CAPTCHA for additional verification\n  \u2022 Consider security questions for added protection\nAvoid These Patterns:\n  \u2022 Do not rely solely on passwords for authentication\n  \u2022 Do not neglect protection against automated attacks\nDetection Methods:\n  semgrep: brute-force-attack, credential-stuffing, password-spraying, python.django.security.audit.session-cookie-secure-false, python.django.security.audit.session-cookie-httponly-false, java.spring.security.audit.spring-csrf-disabled\n  trufflehog: Automated Attack Protection, Basic Auth\nCWE: CWE-307, CWE-308\nASVS: V2.2.1, V2.2.4\nOWASP: A2:2021, A6:2021\nSource: app/rule_cards/owasp/authentication/AUTHENTICATION-003.yml\nType: owasp_generated\n==================================================",
  "metadata": {
    "version": "20250831_185940",
    "source_hash": "a0154e8a617e8c6da1fece012e01e408b5d16b14ffda120ebca18fb938737e4a",
    "rule_count": 33,
    "size_bytes": 39088,
    "created_at": "2025-08-31T18:59:40.283230+00:00",
    "last_updated": "2025-08-31T18:59:40.283230+00:00"
  },
  "created_at": "2025-08-31T18:59:40.283245+00:00"
}