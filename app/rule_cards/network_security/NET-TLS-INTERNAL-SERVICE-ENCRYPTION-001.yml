id: NET-TLS-INTERNAL-SERVICE-ENCRYPTION-001
title: Ensure TLS for internal service communication
severity: high
scope: web-application
requirement: Use TLS for all connectivity between internal, HTTP-based services within
  the application to prevent insecure or unencrypted communications.
do:
- Implement TLS for all internal service communication
- Configure consuming services to trust specific internal CAs and self-signed certificates
- Employ strong authentication methods for intra-service communications
- Consider using a service mesh for microservice architectures to enhance security
dont:
- Allow insecure or unencrypted communication between internal services
detect:
  semgrep:
  - python.requests.security.disabled-cert-validation
  - javascript.lang.security.audit.tls-min-version
verify:
  tests:
  - Verify TLS implementation for internal service communication
  - Verify trust configuration for internal CAs and self-signed certificates
  - Verify strong authentication methods for intra-service communications
  - Consider using a service mesh for microservice architectures
refs:
  asvs:
  - V12.3.3
  - V12.3.4
  - V12.3.5
  cwe:
  - CWE-295
  owasp:
  - A06:2021
