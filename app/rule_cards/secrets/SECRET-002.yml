id: SECRETS-DB-001
title: "Database credentials must not be hardcoded in applications"
severity: critical
scope: all-languages
requirement: "Database connection strings, usernames, passwords, and connection parameters must be externalized from source code and retrieved from secure configuration systems."
do:
  - "Use environment variables for database credentials"
  - "Implement connection string builders that load credentials at runtime"
  - "Use database authentication tokens with automatic renewal"
  - "Store database passwords in enterprise secret management systems"
  - "Implement least-privilege database access with role-based authentication"
  - "Use encrypted connection strings where supported"
dont:
  - "Do not embed database passwords in connection strings within code"
  - "Do not hardcode database usernames and passwords in configuration files"
  - "Do not commit .env files containing database credentials to version control"
  - "Do not use default or placeholder database credentials in any environment"
  - "Do not expose database connection details in application logs or error messages"
detect:
  semgrep:
    - "generic.secrets.security.detected-password"
    - "python.django.security.django-hardcoded-db-password"
    - "java.spring.security.hardcoded-database-password"
    - "javascript.sequelize.security.hardcoded-secret"
  trufflehog:
    - "Database Connection String"
    - "MySQL Password"
    - "PostgreSQL Password"
  codeql:
    - "hardcoded-database-password"
    - "database-query-built-from-user-controlled-sources"
verify:
  tests:
    - "Verify no database credentials appear in source code"
    - "Test application startup fails when database credentials are missing"
    - "Confirm database connections use externally provided credentials"
    - "Validate database connection encryption is enforced"
    - "Test credential rotation scenarios without service interruption"
refs:
  cwe:
    - "CWE-798"
    - "CWE-259"
    - "CWE-256"
  asvs:
    - "V2.1.12"
    - "V6.4.1"
    - "V9.2.3"
  owasp:
    - "A02:2021"
    - "A07:2021"
  standards:
    - "PCI DSS 8.2.1"