id: SECRETS-CLOUD-001
title: "Cloud service credentials and access keys must be secured"
severity: critical
scope: cloud-applications
requirement: "Cloud service access keys, tokens, and credentials must be managed through secure identity and access management systems, never hardcoded in applications or configuration files."
do:
  - "Use cloud-native IAM roles and service accounts for application authentication"
  - "Implement workload identity federation where supported"
  - "Store cloud credentials in dedicated secret management services (AWS Secrets Manager, Azure Key Vault, GCP Secret Manager)"
  - "Use temporary security credentials with automatic rotation"
  - "Apply principle of least privilege to cloud service permissions"
  - "Implement credential scanning in CI/CD pipelines"
dont:
  - "Do not hardcode AWS access keys, secret keys, or session tokens in code"
  - "Do not embed Azure service principal credentials or connection strings"
  - "Do not commit Google Cloud service account keys to version control"
  - "Do not use long-lived credentials when shorter-lived alternatives exist"
  - "Do not grant overly broad permissions to cloud service accounts"
  - "Do not expose cloud credentials in environment variables visible to unauthorized processes"
detect:
  semgrep:
    - "generic.secrets.security.detected-aws-access-key"
    - "generic.secrets.security.detected-azure-key"
    - "generic.secrets.security.detected-gcp-key"
    - "cloud.aws.security.hardcoded-aws-credentials"
  trufflehog:
    - "AWS Access Key"
    - "AWS Secret Key" 
    - "Azure Storage Account Key"
    - "Google Cloud Service Account"
  codeql:
    - "hardcoded-cloud-credentials"
    - "cloud-service-credential-exposure"
verify:
  tests:
    - "Verify no cloud service credentials appear in source code or configuration"
    - "Test application authentication using IAM roles instead of hardcoded keys"
    - "Confirm credential rotation procedures work without service disruption"
    - "Validate that cloud permissions follow least-privilege principles"
    - "Test CI/CD pipeline credential scanning catches hardcoded keys"
refs:
  cwe:
    - "CWE-798"
    - "CWE-540"
    - "CWE-522"
  asvs:
    - "V6.4.1"
    - "V6.4.2"
    - "V14.1.3"
  owasp:
    - "A02:2021"
    - "A05:2021"
  standards:
    - "AWS IAM Best Practices"
    - "Azure Security Best Practices"
    - "GCP IAM Best Practices"