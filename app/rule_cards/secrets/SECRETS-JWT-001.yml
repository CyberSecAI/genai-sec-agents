id: SECRETS-JWT-001
title: "JWT signing secrets must not be hardcoded or use weak values"
severity: critical
scope: jwt-implementations
requirement: "JWT signing keys and secrets must be cryptographically secure, randomly generated, stored in secure key management systems, and never embedded in source code."
do:
  - "Generate JWT signing keys using cryptographically secure random number generators"
  - "Store JWT signing secrets in dedicated key management systems"
  - "Use environment variables or secure configuration for JWT secrets in runtime"
  - "Implement key rotation procedures for JWT signing keys"
  - "Use asymmetric cryptography (RS256, ES256) where possible instead of shared secrets"
  - "Ensure JWT signing keys have sufficient entropy (minimum 256 bits for HS256)"
dont:
  - "Do not use predictable or weak JWT signing secrets (e.g., 'secret', 'key', 'password')"
  - "Do not hardcode JWT secrets in configuration files or source code"
  - "Do not reuse JWT signing keys across different environments or applications"
  - "Do not use the 'none' algorithm for JWT signatures in production"
  - "Do not commit JWT signing keys to version control systems"
detect:
  semgrep:
    - "javascript.jsonwebtoken.security.jwt-hardcode-secret"
    - "python.jwt.security.jwt-hardcode-secret"
    - "java.jwt.security.jwt-hardcode-secret"
    - "generic.secrets.security.jwt-secret"
  trufflehog:
    - "JWT Secret"
    - "Private Key"
  codeql:
    - "hardcoded-jwt-secret"
    - "weak-jwt-signature"
verify:
  tests:
    - "Verify JWT signing secrets are not present in source code"
    - "Test that JWT verification fails with incorrect or missing secrets"
    - "Confirm JWT tokens cannot be generated without proper secret access"
    - "Validate JWT secret rotation procedures maintain token validation capability"
    - "Test rejection of JWT tokens signed with weak or default secrets"
refs:
  cwe:
    - "CWE-798"
    - "CWE-321"
    - "CWE-347"
  asvs:
    - "V3.1.1"
    - "V6.2.1"
    - "V6.4.2"
  owasp:
    - "A02:2021"
    - "A07:2021"
  standards:
    - "RFC 7519"
    - "RFC 7515"