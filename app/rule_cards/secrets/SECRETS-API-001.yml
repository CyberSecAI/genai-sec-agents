id: SECRETS-API-001
title: "API keys must not be hardcoded in source code"
severity: critical
scope: all-languages
requirement: "API keys, tokens, and service credentials must be stored in secure configuration management systems and injected at runtime, never embedded directly in source code."
do:
  - "Use environment variables for API keys"
  - "Store credentials in secure key management systems (AWS Secrets Manager, HashiCorp Vault)"
  - "Implement proper secret rotation procedures"
  - "Use service account authentication where available"
  - "Validate that secrets are loaded from secure sources at application startup"
dont:
  - "Do not hardcode API keys in configuration files committed to version control"
  - "Do not embed tokens directly in source code"
  - "Do not use placeholder or default API keys in production code"
  - "Do not store credentials in environment files (.env) committed to repositories"
  - "Do not log or expose API keys in error messages or debug output"
detect:
  semgrep:
    - "generic.secrets.security.detected-aws-access-key"
    - "generic.secrets.security.detected-generic-secret"
    - "javascript.express.security.express-hardcoded-secret"
    - "python.django.security.django-hardcoded-secret"
  trufflehog:
    - "AWS Access Key"
    - "Generic API Key"
    - "GitHub Token"
  codeql:
    - "hardcoded-credentials"
verify:
  tests:
    - "Verify no API keys appear in source code or configuration files"
    - "Test that application fails gracefully when API keys are missing from environment"
    - "Confirm API keys are loaded from secure configuration at runtime"
    - "Validate secret rotation procedures work without application downtime"
refs:
  cwe:
    - "CWE-798"
    - "CWE-540"
  asvs:
    - "V6.4.1"
    - "V6.4.2"
  owasp:
    - "A02:2021"
  standards:
    - "NIST SP 800-57"