id: NODE-004
title: Set request size limits to prevent DoS attacks
severity: medium
scope: web-application
requirement: Implement request size limits to prevent attackers from sending large
  request bodies that can exhaust server resources and lead to Denial of Service (DoS)
  attacks.
do:
- Limit request body size for POST, PUT, and DELETE requests
- Use libraries like raw-body to set request size limits
- Differentiate request size limits based on content types (e.g., JSON, multipart)
dont:
- Do not allow unlimited request body sizes for all requests
- Avoid processing large request bodies without size restrictions
detect:
  semgrep:
  - javascript.nodejs.security.nodejs-request-size-limit
verify:
  tests:
  - Send requests with varying sizes to verify limits are enforced
  - Test application behavior when request size exceeds defined limits
refs:
  cwe:
  - CWE-770
  - CWE-400
  owasp:
  - A06:2021
  - A07:2021
