id: NODE-CODE-HANDLING-001
title: Use flat Promise chains to avoid Callback Hell
severity: high
scope: web-application
requirement: Avoid nested callback functions in Node.js applications by using flat
  Promise chains to improve code readability, error handling, and maintainability.
do:
- Refactor asynchronous code to use Promises for top-down execution
- Utilize .then() and .catch() functions to handle errors effectively
- Convert callback-based functions to return Promises for better error propagation
dont:
- Do not rely solely on nested callback functions for asynchronous operations
- Avoid deeply nested callback structures that lead to unreadable code
detect:
  semgrep:
  - javascript.nodejs.security.nodejs-callback-hell
  - javascript.nodejs.security.nodejs-promise-chain
verify:
  tests:
  - Review codebase to ensure flat Promise chains are used instead of nested callbacks
  - Test error handling scenarios to confirm proper propagation and handling
refs:
  cwe:
  - CWE-829
  - CWE-561
  owasp:
  - A03:2021
  - A10:2021
