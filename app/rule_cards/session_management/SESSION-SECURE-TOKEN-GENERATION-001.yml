id: SESSION-SECURE-TOKEN-GENERATION-001
title: Ensure unique and cryptographically secure session tokens
severity: medium
scope: web-application
requirement: Use either self-contained or reference tokens that are dynamically generated
  for session management. If reference tokens are used, ensure they are unique, generated
  using a CSPRNG with at least 128 bits of entropy.
do:
- Use self-contained or reference tokens for session management
- Ensure reference tokens are unique and generated using CSPRNG with 128 bits of entropy
dont:
- Use static API secrets and keys for session tokens
detect:
  semgrep:
  - javascript.express.security.audit.express-session-no-secret
  - python.django.security.audit.session-cookie-httponly-false
verify:
  tests:
  - Verify usage of unique and cryptographically secure session tokens
refs:
  asvs:
  - V7.2.2
  - V7.2.3
  cwe:
  - CWE-330
  owasp:
  - A2:2021
