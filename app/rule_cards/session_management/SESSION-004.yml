id: SESSION-004
title: Generate new session token on user authentication
severity: high
scope: web-application
requirement: Generate a new session token upon user authentication, including re-authentication,
  and terminate the current session token. Ensure the session inactivity timeout and
  absolute maximum session lifetime are documented with justification for deviations
  from NIST SP 800-63B re-authentication requirements.
do:
- Generate a new session token on user authentication
- Document session inactivity timeout and absolute maximum session lifetime with justification
dont:
- Reuse session tokens
detect:
  semgrep:
  - javascript.express.security.audit.express-session-no-secret
  - python.django.security.audit.session-cookie-httponly-false
verify:
  tests:
  - Verify new session token generation on user authentication
  - Review documentation for session inactivity timeout and absolute maximum session
    lifetime
refs:
  asvs:
  - V7.1.1
  - V7.2.4
  - V7.3.1
  cwe:
  - CWE-384
  owasp:
  - A2:2021
