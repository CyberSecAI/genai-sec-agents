id: SESSION-003
title: Generate unique reference tokens with sufficient entropy
severity: medium
scope: web-application/api
requirement: If reference tokens are used for user sessions, ensure they are unique
  and possess sufficient entropy for security.
do:
- Generate unique reference tokens using CSPRNG with at least 128 bits of entropy
dont:
- Reuse reference tokens or generate them without sufficient entropy
detect:
  semgrep:
  - unique-reference-tokens
verify:
  tests:
  - Check that reference tokens are unique and have sufficient entropy
refs:
  cwe:
  - CWE-330
  asvs:
  - V7.2.3:2021
  owasp:
  - A2:2021
