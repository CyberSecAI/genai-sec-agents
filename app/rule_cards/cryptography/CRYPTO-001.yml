detect:
  semgrep:
  - crypto.key-hardcoded
  - generic.secrets.security.detected-hardcoded-key
  - crypto.weak-crypto
do:
- Implement approved key derivation functions with key stretching parameters when
  deriving secret keys from passwords
- Use cryptographically secure pseudo-random number generators (CSPRNG) with at least
  128 bits of entropy for generating non-guessable random numbers and strings
- Use approved cryptographic algorithms and modes of operation for key generation,
  seeding, digital signature generation, and verification
- Implement full memory encryption to protect sensitive data while in use
- Minimize data exposure during processing and encrypt data immediately after use
  or as soon as feasible
dont:
- Expose application encryption keys in client-side code or public repositories
id: CRYPTO-001
refs:
  asvs:
  - V11.4.4
  - V11.5.1
  - V11.6.1
  - V11.7.1
  - V11.7.2
  cwe:
  - CWE-327
  - CWE-328
  - CWE-329
  owasp:
  - A10:2021
requirement: Application encryption keys should be properly protected, not exposed
  in client-side code or public ...
scope: web-application
severity: high
title: Application Key Protection and Management
verify:
  tests:
  - Verify implementation meets security requirements
