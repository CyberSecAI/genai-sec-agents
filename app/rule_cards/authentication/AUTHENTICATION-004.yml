detect:
  semgrep:
  - javascript.express.security.audit.express-session-no-secret
  - python.django.security.audit.session-cookie-secure-false
do:
- Ensure SAML assertions are processed uniquely and not reused
dont:
- Do not reuse SAML assertions within their validity period
id: AUTHENTICATION-004
refs:
  asvs:
  - V6.8.3
  cwe:
  - CWE-352
  owasp:
  - A2:2021
requirement: SAML assertions are uniquely processed and used only once within the
  validity period to prevent replay attacks.
scope: web-application
severity: medium
title: Unique Processing of SAML Assertions
verify:
  tests:
  - Test uniqueness and non-replay of SAML assertions
