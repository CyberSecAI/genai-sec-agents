id: AUTH-048
title: One-time Use of Multi-factor Authentication Secrets
severity: medium
scope: web-application
requirement: Ensure that lookup secrets, out-of-band authentication requests or codes,
  and time-based one-time passwords (TOTPs) are only usable once.
do:
- Implement mechanisms to invalidate and prevent reuse of multi-factor authentication
  secrets after a single use
dont:
- Allow reuse of multi-factor authentication secrets
detect:
  semgrep:
  - multi-factor-authentication-secrets-reuse
verify:
  tests:
  - Verify that multi-factor authentication secrets are only usable once
refs:
  cwe:
  - CWE-640
  asvs:
  - V6.5.1
  owasp:
  - A11:2021
