detect:
  semgrep:
  - javascript.express.security.audit.express-session-no-secret
  - python.django.security.audit.session-cookie-secure-false
do:
- Implement mechanisms to prevent replay of SAML assertions
- Ensure unique processing and usage of SAML assertions
dont:
- Allow reuse of SAML assertions within validity period
id: AUTH-NEW-004
refs:
  asvs:
  - V6.8.3
  cwe:
  - CWE-287
  owasp:
  - A07:2021
requirement: Ensure SAML assertions are uniquely processed and used only once within
  the validity period to prevent replay attacks.
scope: web-application
severity: medium
title: Prevent Replay Attacks with SAML Assertions
verify:
  tests:
  - Test prevention of replay attacks with SAML assertions
