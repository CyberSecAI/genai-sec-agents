id: AUTH-NEW-002
title: Prevent Identity Spoofing with Multiple Identity Providers
severity: medium
scope: web-application
requirement: Verify that the user's identity cannot be spoofed via another supported
  identity provider by using a combination of the IdP ID and the user's ID.
do:
- Use a combination of IdP ID and user's ID to uniquely identify users
- Implement checks to prevent identity spoofing across multiple IdPs
dont:
- Rely solely on user identifier without considering IdP ID
detect:
  semgrep:
  - javascript.express.security.audit.express-session-no-secret
  - python.django.security.audit.session-cookie-secure-false
verify:
  tests:
  - Test identity verification across multiple IdPs
refs:
  asvs:
  - V6.8.1
  cwe:
  - CWE-287
  owasp:
  - A07:2021
