detect:
  semgrep:
  - javascript.express.security.audit.express-session-no-secret
  - python.django.security.audit.session-cookie-secure-false
do:
- Use a trusted time source for checking TOTPs to prevent manipulation.
- Implement mechanisms to ensure TOTPs are not based on client-provided time.
dont:
- Do not rely on untrusted time sources for validating TOTPs.
id: AUTHENTICATION-010
refs:
  asvs:
  - V6.5.8
  cwe:
  - CWE-287
  owasp:
  - A07:2021
requirement: Time-based one-time passwords (TOTPs) are checked based on a time source
  from a trusted service and not from an untrusted or client provided time.
scope: web-application
severity: high
title: Secure Time-based One-time Passwords (TOTPs)
verify:
  tests:
  - Verify that TOTPs are validated using a trusted time source.
