id: AUTH-PASSWORD-002
title: Secure Time-based One-time Passwords (TOTPs)
severity: high
scope: web-application
requirement: TOTPs must be checked based on a time source from a trusted service.
do:
- Validate TOTPs using a trusted time source
dont:
- Rely on untrusted or client-provided time for TOTPs
detect:
  semgrep:
  - javascript.express.security.audit.express-session-no-secret
  - python.django.security.audit.session-cookie-secure-false
verify:
  tests:
  - Verify TOTP validation against trusted time source
refs:
  asvs:
  - V6.5.8
  cwe:
  - CWE-347
  owasp:
  - A3:2021
