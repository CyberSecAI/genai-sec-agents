```yaml
id: LOGGING-004
title: "Implement tamper detection and access controls for log data"
severity: high
scope: web-application
requirement: "Implement mechanisms to detect tampering with log data and enforce access controls to prevent unauthorized modification, deletion, or access to the logs."
do:
  - "Implement tamper detection mechanisms to identify modifications or deletions in log entries"
  - "Enforce access controls to restrict access to log data to authorized personnel only"
  - "Store log data in read-only media as soon as possible"
dont:
  - "Do not allow unrestricted access to log data"
detect:
  semgrep:
    - "logging.tamper-detection"
    - "logging.access-controls"
  trufflehog:
    - "Data Tampering"
verify:
  tests:
    - "Verify that tamper detection mechanisms are functioning correctly"
    - "Test access controls on log data to ensure restricted access"
refs:
  cwe:
    - "CWE-117"
    - "CWE-284"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-005
title: "Encrypt log data in transit and at rest"
severity: high
scope: web-application
requirement: "Encrypt log data both in transit and at rest to protect sensitive information from unauthorized access or interception."
do:
  - "Use secure transmission protocols for sending log data over untrusted networks"
  - "Encrypt log data stored at rest using strong encryption algorithms"
  - "Consider data masking or encryption for sensitive log entries"
dont:
  - "Do not transmit log data over untrusted networks without encryption"
detect:
  semgrep:
    - "logging.encryption-transit"
    - "logging.encryption-rest"
  trufflehog:
    - "Sensitive Data Exposure"
verify:
  tests:
    - "Verify that log data is encrypted in transit and at rest"
    - "Test encryption mechanisms during security testing to ensure effectiveness"
refs:
  cwe:
    - "CWE-311"
    - "CWE-312"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-006
title: "Implement log rotation and retention policies"
severity: medium
scope: web-application
requirement: "Establish log rotation and retention policies to manage log file sizes, prevent disk space exhaustion, and comply with legal and regulatory requirements."
do:
  - "Implement log rotation to manage log file sizes and prevent disk space exhaustion"
  - "Define retention periods for log data based on legal, regulatory, and operational needs"
  - "Regularly review and adjust log rotation and retention policies as necessary"
dont:
  - "Do not neglect log rotation and retention policies, leading to unmanageable log file sizes"
detect:
  semgrep:
    - "logging.log-rotation"
    - "logging.retention-policies"
  trufflehog:
    - "Data Retention"
verify:
  tests:
    - "Verify that log rotation is functioning as intended"
    - "Review log retention policies to ensure compliance with legal and operational requirements"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-007
title: "Include sufficient event attributes in log entries"
severity: medium
scope: web-application
requirement: "Ensure that each log entry includes essential event attributes such as timestamp, user identity, event type, and description for effective monitoring and analysis."
do:
  - "Include timestamp, user identity, event type, and description in each log entry"
  - "Consider additional attributes like severity, action, object, and result status for comprehensive event logging"
dont:
  - "Do not omit critical event attributes in log entries, hindering analysis and monitoring"
detect:
  semgrep:
    - "logging.event-attributes"
  trufflehog:
    - "Sensitive Data Exposure"
verify:
  tests:
    - "Verify that essential event attributes are present in all log entries"
    - "Test the completeness of event attributes during security testing"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-008
title: "Implement customizable logging levels"
severity: medium
scope: web-application
requirement: "Implement customizable logging levels to adjust the verbosity of logging based on severity, threat level, and operational needs while ensuring critical events are always captured."
do:
  - "Allow customization of logging levels to adjust verbosity"
  - "Ensure default logging level provides sufficient detail for operational needs"
  - "Prevent deactivation of critical event logging or compliance-required logs"
dont:
  - "Do not allow complete deactivation of application logging or critical event logging"
detect:
  semgrep:
    - "logging.customizable-levels"
  trufflehog:
    - "Sensitive Data Exposure"
verify:
  tests:
    - "Verify that logging levels can be customized as needed"
    - "Test the default logging level to ensure it captures essential events"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-009
title: "Implement centralized log collection and management"
severity: medium
scope: web-application
requirement: "Implement a centralized log collection and management system (e.g., SIEM or SEM) to aggregate, analyze, and monitor log data from various application components for improved security monitoring and incident response."
do:
  - "Set up a centralized log collection system for aggregating log data"
  - "Utilize SIEM or SEM tools for log analysis and monitoring"
  - "Integrate log data from different application components for comprehensive security monitoring"
dont:
  - "Do not rely solely on decentralized or siloed log storage systems"
detect:
  semgrep:
    - "logging.centralized-collection"
  trufflehog:
    - "Data Leakage"
verify:
  tests:
    - "Verify that log data is being centrally collected and managed"
    - "Test the integration of log data from various components during security testing"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-010
title: "Perform regular testing and verification of logging mechanisms"
severity: low
scope: web-application
requirement: "Regularly test and verify the functionality of logging mechanisms to ensure they are operational, accurate, and effective in capturing security-relevant events."
do:
  - "Include logging mechanisms in code review and application testing processes"
  - "Verify that logs are being generated as expected during security verification"
  - "Test the resilience of logging mechanisms against common attacks and failures"
dont:
  - "Do not assume logging mechanisms are functioning correctly without regular testing"
detect:
  semgrep:
    - "logging.testing-verification"
  trufflehog:
    - "Sensitive Data Exposure"
verify:
  tests:
    - "Conduct regular testing of logging mechanisms to ensure proper functionality"
    - "Verify that logs are accurate and complete during security assessments"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-011
title: "Implement secure transmission protocols for log data"
severity: low
scope: web-application
requirement: "Use secure transmission protocols when sending log data over untrusted networks to prevent interception or tampering of log entries during transit."
do:
  - "Utilize secure transmission protocols (e.g., TLS) for transmitting log data over untrusted networks"
  - "Encrypt log data before transmission to protect confidentiality and integrity"
dont:
  - "Do not transmit log data over untrusted networks without encryption"
detect:
  semgrep:
    - "logging.secure-transmission"
  trufflehog:
    - "Sensitive Data Exposure"
verify:
  tests:
    - "Verify that log data is transmitted using secure protocols"
    - "Test the encryption of log data during transmission for effectiveness"
refs:
  cwe:
    - "CWE-311"
    - "CWE-312"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-012
title: "Enable alerting and monitoring for critical events"
severity: low
scope: web-application
requirement: "Set up alerting mechanisms to notify responsible teams about critical events in the logs and ensure continuous monitoring for immediate response to security incidents."
do:
  - "Configure alerting for critical events such as authentication failures or high-risk activities"
  - "Monitor log data continuously for anomalies or suspicious activities"
  - "Integrate log alerts with incident response processes for timely action"
dont:
  - "Do not overlook setting up alerts for critical security events in logs"
detect:
  semgrep:
    - "logging.alerting-mechanisms"
  trufflehog:
    - "Data Leakage"
verify:
  tests:
    - "Verify that alerting mechanisms are triggered for critical events"
    - "Test the monitoring of log data for timely detection of security incidents"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-013
title: "Regularly review and adjust log rotation and retention policies"
severity: low
scope: web-application
requirement: "Periodically review log rotation and retention policies to ensure log file sizes are managed effectively, and retention periods comply with legal, regulatory, and operational requirements."
do:
  - "Review log rotation and retention policies at regular intervals"
  - "Adjust log rotation settings based on changing operational needs"
  - "Ensure retention periods align with legal and regulatory obligations"
dont:
  - "Do not neglect reviewing log rotation and retention policies, leading to compliance issues"
detect:
  semgrep:
    - "logging.review-policies"
  trufflehog:
    - "Data Retention"
verify:
  tests:
    - "Verify that log rotation and retention policies are periodically reviewed"
    - "Review and adjust log rotation settings during compliance checks"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-014
title: "Implement log sanitization to protect sensitive data"
severity: low
scope: web-application
requirement: "Apply log sanitization techniques to remove or mask sensitive data such as passwords, personal information, and encryption keys from log entries to prevent exposure of confidential information."
do:
  - "Implement log sanitization to remove sensitive data before logging"
  - "Mask or encrypt sensitive information like passwords and personal data in log entries"
  - "Consider pseudonymization techniques for indirect identifiers in log data"
dont:
  - "Do not log sensitive information in clear text without sanitization"
detect:
  semgrep:
    - "logging.sanitization"
  trufflehog:
    - "Sensitive Data Exposure"
verify:
  tests:
    - "Verify that log sanitization techniques are applied to sensitive data"
    - "Test the effectiveness of data masking in log entries during security assessments"
refs:
  cwe:
    - "CWE-312"
    - "CWE-315"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-015
title: "Synchronize time across all servers and devices for accurate logging"
severity: low
scope: web-application
requirement: "Ensure time synchronization across all servers and devices to maintain accurate timestamps in log entries, facilitating correlation and analysis of events across the application environment."
do:
  - "Implement time synchronization mechanisms for all servers and devices"
  - "Use network time protocols (NTP) to ensure consistent time across the infrastructure"
  - "Regularly monitor and adjust time settings to prevent drift"
dont:
  - "Do not overlook time synchronization, leading to inaccurate event timestamps"
detect:
  semgrep:
    - "logging.time-synchronization"
  trufflehog:
    - "Data Integrity"
verify:
  tests:
    - "Verify that time synchronization is in place for all servers and devices"
    - "Test the accuracy of event timestamps in log entries"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-016
title: "Implement log handler for consistent log generation"
severity: low
scope: web-application
requirement: "Develop a standardized log handler module that can be used across multiple applications to ensure consistent log generation, format, and content for easier management and analysis."
do:
  - "Create a reusable log handler module for consistent log generation"
  - "Define a standard interface for logging across different application components"
  - "Ensure the log handler is thoroughly tested and integrated into approved modules"
dont:
  - "Do not rely on ad-hoc logging mechanisms that vary across applications"
detect:
  semgrep:
    - "logging.log-handler"
  trufflehog:
    - "Data Leakage"
verify:
  tests:
    - "Verify that the log handler module is being used for log generation"
    - "Test the consistency of log format and content across applications"
refs:
  cwe:
    - "CWE-778"
    - "CWE-117"
  owasp:
    - "A10:2021"
    - "A13:2021"
```
```yaml
id: LOGGING-017
title: "Perform input validation on event data for log injection prevention"
severity: low
scope: web-application
requirement: "Implement input validation on event data to prevent log injection attacks and ensure that only valid and sanitized information is included in log entries."
do:
  - "Validate event data inputs to prevent log injection vulnerabilities"
  - "Sanitize input data to remove malicious or unexpected characters"
  - "Implement alerting for input validation failures to prevent logging of potentially harmful data"
dont:
  - "Do not log unvalidated or unsanitized event data, risking log injection vulnerabilities"
detect:
  semgrep:
    - "logging.input-validation"
  trufflehog:
    - "Data Injection"
verify:
  tests:
    - "Verify that input validation is applied to event data before logging"
    -