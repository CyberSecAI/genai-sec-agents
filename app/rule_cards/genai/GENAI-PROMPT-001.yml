id: GENAI-PROMPT-001
title: "GenAI applications must implement prompt injection prevention controls"
severity: high
scope: genai-applications
requirement: "Generative AI applications must validate, sanitize, and control user inputs to prevent prompt injection attacks that could compromise system behavior, data access, or generate harmful content."
do:
  - "Implement input validation and sanitization for all user prompts"
  - "Use prompt templates with parameterized inputs rather than string concatenation"
  - "Apply content filtering to detect and block prompt injection patterns"
  - "Implement rate limiting and throttling for prompt processing"
  - "Use separate contexts for system instructions and user inputs"
  - "Log and monitor suspicious prompt patterns for security analysis"
dont:
  - "Do not directly concatenate user input into system prompts"
  - "Do not trust user input without validation and sanitization"
  - "Do not expose internal system prompts or instructions to users"
  - "Do not allow unlimited or uncontrolled prompt processing"
  - "Do not ignore or bypass prompt injection detection mechanisms"
  - "Do not store sensitive information in prompt templates accessible to users"
detect:
  semgrep:
    - "generic.genai.security.prompt-injection"
    - "python.genai.security.unsafe-prompt-concatenation"
    - "javascript.genai.security.prompt-template-injection"
    - "generic.genai.security.system-prompt-exposure"
  custom:
    - "Detect string concatenation patterns in prompt construction"
    - "Identify missing input validation in prompt processing functions"
    - "Flag direct user input insertion into system prompts"
verify:
  tests:
    - "Verify prompt injection attempts are detected and blocked"
    - "Test that system instructions remain isolated from user inputs"
    - "Confirm input validation prevents malicious prompt patterns"
    - "Validate rate limiting prevents prompt abuse"
    - "Test content filtering blocks harmful or manipulative inputs"
refs:
  cwe:
    - "CWE-77"
    - "CWE-78"
    - "CWE-94"
    - "CWE-20"
  asvs:
    - "V5.1.1"
    - "V5.1.3"
    - "V5.3.1"
    - "V12.1.1"
  owasp:
    - "LLM01:2023"
    - "A03:2021"
  standards:
    - "OWASP Top 10 for Large Language Model Applications"
    - "NIST AI RMF 1.0"
    - "ISO/IEC 27001:2022"