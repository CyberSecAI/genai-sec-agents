id: FILE-UPLOAD-002
title: Secure file naming and storage location
severity: high
scope: web-application
requirement: Generate random filenames for uploaded files and store them in a secure
  location outside the webroot. Server-side file processing, such as file decompression,
  ignores user-provided path information to prevent vulnerabilities such as zip slip.
do:
- Generate random filenames for uploaded files
- Store files in a secure location outside the webroot
- Ignore user-provided path information during file processing
dont:
- Use predictable filenames for uploaded files
- Store files in insecure locations within the webroot
detect:
  semgrep:
  - python.lang.security.audit.dangerous-system-call
  - javascript.lang.security.audit.path-traversal
verify:
  tests:
  - Test file upload validation and processing security
refs:
  asvs:
  - V5.3.3
  cwe:
  - CWE-434
  owasp:
  - A01:2021
