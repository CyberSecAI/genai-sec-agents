id: CLICKJACKING-DEFENSE-001
title: Implement X-Frame-Options header to prevent Clickjacking
severity: high
scope: web-application
requirement: Set the X-Frame-Options HTTP response header to DENY, SAMEORIGIN, or
  ALLOW-FROM uri to prevent the browser from loading the page in a frame. This helps
  defend against Clickjacking attacks by ensuring content is not embedded into other
  sites.
do:
- Set X-Frame-Options header to DENY to prevent any domain from framing the content
- Set X-Frame-Options header to SAMEORIGIN to only allow the current site to frame
  the content
- Use ALLOW-FROM uri to permit specific URIs to frame the page (deprecated, check
  browser support)
dont:
- Do not rely solely on meta-tags for X-Frame-Options, apply the header in HTTP responses
detect:
  semgrep:
  - http.response-header.x-frame-options-deny
  - http.response-header.x-frame-options-sameorigin
  - http.response-header.x-frame-options-allow-from
  - python.django.security.audit.xss-filter-disabled
  - python.flask.security.audit.flask-cors-origin-wildcard
  - java.spring.security.audit.spring-security-headers
  trufflehog:
  - X-Frame-Options
verify:
  tests:
  - Verify X-Frame-Options header is correctly set in HTTP responses
  - Test that the page cannot be framed in different domains
refs:
  cwe:
  - CWE-693
  - CWE-1021
  asvs:
  - V6.1.1
  - V6.1.2
  owasp:
  - A6:2021
  standards:
  - RFC 7034
