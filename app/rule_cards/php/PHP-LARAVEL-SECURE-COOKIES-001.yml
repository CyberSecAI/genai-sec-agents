id: PHP-LARAVEL-SECURE-COOKIES-001
title: Secure Cookie Configuration for Laravel Applications
severity: medium
scope: web-application
requirement: Configure secure cookie attributes to enhance the security of session
  management and prevent common attacks like session hijacking and XSS.
do:
- Enable cookie encryption middleware for sensitive data
- Set 'http_only' attribute to 'true' to prevent client-side script access
- Configure 'same_site' attribute to 'lax' or 'strict' for better cookie security
dont:
- Avoid disabling cookie encryption middleware without a specific use case
detect:
  semgrep:
  - php.laravel.security.cookie-settings
  - python.django.security.audit.xss.direct-use-of-httpresp-write
  - javascript.browser.security.audit.dom-based-xss
  - java.spring.security.audit.spring-xss
verify:
  tests:
  - Verify cookie encryption middleware is enabled
  - Check 'http_only' and 'same_site' attributes are properly configured
refs:
  owasp:
  - A03:2021
  - A07:2021
  - A10:2021
